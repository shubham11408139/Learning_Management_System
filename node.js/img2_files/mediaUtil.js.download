CEBWidget.ready(function(){});var cleanHTML=function(a){if(typeof a==="string"&&a!=""){a=a.replace(/&lt;/g,"<").replace(/&gt;/g,">");a=app.stripScripts(a)}return a};var domfromString=function(b){var a=$("<cleaner></cleaner>").html(b);return a};var processMedia=function(d,c){var e=cleanHTML(d);var b=domfromString(e);var a=b.find("cebmedia");$.each(a,function(g,h){cebMediaNode=$(h);var f=cebMediaNode.data("uuid");cebMediaNode.html();getDTOfromUUID(f,cebMediaNode)})};var getDTOfromUUID=function(c,a){var b=mediaDetailsURL+c;var d=AjaxRequest.send(b,"post",null,null,null,null,null);d.success(function(i){if(i.Data){var f=i.Data.filePath;var h="";if(player.CDN_URL){h=player.CDN_URL.replace("4.3/tc/player","").replace("/player","");if(location.host.startsWith("localhost")||location.host.startsWith("tcdevvm")){h="https://dev1-talentcentral.cebglobal.eu/cdn"}f=h+i.Data.filePath}var e={name:i.Data.fileName,type:i.Data.type,uuid:i.Data.uuid,path:f,dom_obj:a};if(i.Data.type=="IMAGE"){e.fileWidth=i.Data.fileWidth;e.fileHeight=i.Data.fileHeight}var g={};if(i.Data.lstMediaAttr&&$.isArray(i.Data.lstMediaAttr)&&i.Data.lstMediaAttr.length>0){$.each(i.Data.lstMediaAttr,function(k,l){if(i.Data.type=="IMAGE"){if(l.value){g[l.type]=l.value}else{g[l.type]="IMAGE"}}else{g[l.type]=h+l.value}})}else{if(i.Data.type=="IMAGE"){g.ALT_TEXT=""}}e.mediaAttrs=g;e.error=false;var j=getMediaHTMLbyType(e);replaceMediaNodeHTML(e.uuid,j);if(e.type=="VIDEO"){setTimeout(function(){var l="media_"+e.uuid;var k=e.name;initializeVideoPlayer(l,k)},1000);handleToggleTranscript(e)}else{if(e.type=="AUDIO"){loadTranscript(e);handleToggleTranscript(e)}}}});d.error(function(e){});d.complete(function(e){})};var handleToggleTranscript=function(b){var c="#transcriptToggle_"+b.uuid;var a="#transcript_"+b.uuid;$(c).on("change",function(){if(this.checked){$(a).removeClass("hide")}else{$(a).addClass("hide")}})};var loadTranscript=function(b){var a="transcript_"+b.uuid;if(b.mediaAttrs.TRANSCRIPT){var c=AjaxRequest.send(b.mediaAttrs.TRANSCRIPT,"get","text/plain;charset=UTF-8","text",null,null,null,null,false,false);c.success(function(d){$("#"+a).html(d)});c.error(function(d){});c.complete(function(d){})}};var replaceMediaNodeHTML=function(a,b){$("cebmedia").filter(function(){return $(this).data("uuid")==a}).replaceWith(b)};var activateCustomVideoButtons=function(c){var d=$(".px-video-img-captions-container",c);var b=$(".px-video-play",c);var a=$("video",d);if(a.length>0&&b.length>0){d.append('<div class="videoplayerfade"><div></div></div>');d.append('<div class="videoplayercenterbtn shl-icon_nav_next"></div>');$(".px-video-play",c).on("click",function(f){$(".videoplayercenterbtn",d).addClass("hidden");$(".videoplayerfade",d).addClass("hidden")});$(".px-video-pause",c).on("click",function(f){$(".videoplayercenterbtn",d).removeClass("hidden");$(".videoplayerfade",d).removeClass("hidden")});$(".px-video-restart",c).on("click",function(f){$(".videoplayercenterbtn",d).addClass("hidden");$(".videoplayerfade",d).addClass("hidden")});$(".videoplayercenterbtn",d).on("click",function(f){$(".videoplayercenterbtn",d).addClass("hidden");$(".videoplayerfade",d).addClass("hidden");$(".px-video-play",c).click()});a.on("click",function(f){$(".videoplayercenterbtn",d).removeClass("hidden");$(".videoplayerfade",d).removeClass("hidden");$(".px-video-pause",c).click()})}};var initializeVideoPlayer=function(b,a){new InitPxVideo({videoId:b,captionsOnDefault:true,seekInterval:20,videoTitle:a,debug:true});activateCustomVideoButtons($("#"+b))};var getMediaHTMLbyType=function(a){switch(a.type){case"AUDIO":return wrapAudioTag(a);break;case"VIDEO":return wrapVideoTag(a);break;default:return wrapImgTag(a)}};var wrapAudioTag=function(b){var a='<audio class= "ceb-audio-100" controls><source src="'+b.path+'" type="audio/mpeg">Your browser does not support the audio element.</audio>';var c=getTranscriptHTML(b);a+=c;return a};var wrapVideoTag=function(b){var a='<div class="px-video-container" style="width:100% !important;" id="media_'+b.uuid+'">';a+='<div class="px-video-img-captions-container">';a+='<div class="px-video-captions hide" aria-hidden="true"></div>';if(b.mediaAttrs.AUDIO_DESCRIPTION){if(b.mediaAttrs.POSTER){a+='<video crossorigin="anonymous" width="100%" height="200%" controls data-audio-desc-src="'+b.mediaAttrs.AUDIO_DESCRIPTION+'" poster="'+b.mediaAttrs.POSTER+'">'}else{a+='<video crossorigin="anonymous" width="100%" height="200%" controls data-audio-desc-src="'+b.mediaAttrs.AUDIO_DESCRIPTION+'">'}}else{if(b.mediaAttrs.POSTER){a+='<video crossorigin="anonymous" width="100%" height="200%" controls poster="'+b.mediaAttrs.POSTER+'">'}else{a+='<video crossorigin="anonymous" width="100%" height="200%" controls >'}}a+='<source src="'+b.path+'" type="video/mp4" />';if(b.mediaAttrs.CAPTION){a+='<track kind="captions" label="English captions" src="'+b.mediaAttrs.CAPTION+'" srclang="en" default />'}if(b.mediaAttrs.TRANSCRIPT){a+='<track kind="descriptions" label="English captions" src="'+b.mediaAttrs.TRANSCRIPT+'" srclang="en" default />'}a+="<div>";a+='<a href="'+b.path+'"><img src="media/foo.jpg" alt="download video" /></a>';a+="</div></video></div>";a+='<div class="px-video-controls"></div>';a+="</div>";var c=getTranscriptHTML(b);a+=c;return a};var wrapImgTag=function(e){var h="img-responsive prefetch-image-placeholder media-images player-image-"+e.uuid;var d="<img id=player-image-"+e.uuid+' class ="'+h+'" alt="'+e.mediaAttrs.ALT_TEXT+'" title="'+e.mediaAttrs.ALT_TEXT+'" style="margin-left:auto;margin-right:auto;display:block;width:100%;" >';var i=$(d);var b=$("cebmedia").filter(function(){return $(this).data("uuid")==e.uuid});var a=b.parent().width();var f=calcNewDimensions(a,e.fileWidth,e.fileHeight);if(a==0||f.height==0){a="100%";f.height="100%"}i.css("width",a).css("height",f.height);i.attr("data-aspect-ratio",f.aspectRatio);var g=new Image();g.onload=function(){$(".player-image-"+e.uuid).each(function(k,j){$(this).attr("src",e.path).fadeIn(500)})};g.src=e.path;var c=i.get(0).outerHTML;return c};var calcNewDimensions=function(d,e,c){var f=e/c;var b=d/f;var a={height:b,width:d,aspectRatio:f};return a};var getTranscriptHTML=function(b){var a="";if(b.mediaAttrs.TRANSCRIPT){a='<div class="transcript-control">'}else{a='<div class="transcript-control hidden">'}a+='<input type="checkbox" role="checkbox" id="transcriptToggle_'+b.uuid+'" class="app sr-only _toggleButton" name="transcriptToggle_'+b.uuid+'" tabindex="0" />';a+='<label for="transcriptToggle_'+b.uuid+'" class="fRight margin-left-5 inline">';a+='<span class="off-screen">'+app.getLocalizedText("player.media.transcript","Transcript")+".</span>";a+='<span class="_tButton">';a+='<span class="_smallCircle">&#160;</span>';a+="</span>";a+="</label>";a+="<span>"+app.getLocalizedText("player.media.transcript","Transcript")+"</span>";a+='<div id="transcript_'+b.uuid+'" class="transcript-wrap hide">'+app.getLocalizedText("player.media.no_transcript","No data available in table")+"</div>";a+="<div>";return a};var updateImageSizes=function(){$(".media-images").each(function(c,b){var e=$(b).parent().width();var d=$(b).data("aspectRatio");var a=e/d;$(b).css("width",e).css("height",a)})};$(window).resize(function(){updateImageSizes()});